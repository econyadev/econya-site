<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Econya — Mes comptes</title>
  <meta name="description" content="Reliez votre banque, analysez vos dépenses et vos revenus avec Econya." />

  <!-- Favicon + CSS de ton site s'ils existent -->
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  <link rel="stylesheet" href="style.css" />

  <!-- Sécurité de base : on autorise notre backend Render -->
  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self';
          script-src 'self';
          style-src 'self' 'unsafe-inline';
          img-src 'self' data:;
          connect-src 'self' https://econya-backend.onrender.com;
          object-src 'none';
          base-uri 'self';
          frame-ancestors 'self';
        ">
</head>
<body>

  <!-- Barre haute minimaliste (reutilise la charte) -->
  <header class="topbar">
    <a class="brand" href="index.html">
      <img src="logo.svg" alt="Econya" height="28" />
      <span>Econya</span>
    </a>
    <nav class="nav">
      <a href="comparateur.html">Comparateur Pro</a>
      <a href="coach-eco.html">Coach Eco</a>
      <a href="partenaires.html">Partenaires</a>
      <a href="playbooks.html">Playbooks</a>
    </nav>
  </header>

  <main class="container" style="max-width:980px">
    <h1>Mes comptes</h1>
    <p class="muted">Reliez votre banque (démo), puis consultez vos analyses et transactions par mois.</p>

    <!-- Statut API + Connexion banque -->
    <section class="card" style="margin-top:12px">
      <h2 style="margin:0 0 12px 0">Connexion bancaire</h2>

      <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
        <div id="api-status" class="badge">Vérification du backend…</div>
        <div id="ob-status" class="badge ghost">Banque non reliée</div>
      </div>

      <div style="margin-top:12px;display:flex;gap:12px;flex-wrap:wrap">
        <button id="ob-connect-btn" class="btn">Relier ma banque (démo)</button>
        <button id="ob-reset-btn" class="btn ghost">Réinitialiser (tests)</button>
      </div>

      <p class="muted" style="margin-top:8px">
        Démo : un parcours fictif s’ouvre, cliquez “Autoriser” puis revenez ici. Le statut passera en <strong>relié</strong>.
      </p>
    </section>

    <!-- Aperçu analytique -->
    <section class="card" style="margin-top:20px">
      <h2 style="margin:0 0 12px 0">Synthèse</h2>
      <div class="kpi-grid">
        <div class="kpi">
          <div class="kpi-label">Dépenses du mois</div>
          <div class="kpi-value" id="kpi-exp">—</div>
        </div>
        <div class="kpi">
          <div class="kpi-label">Revenus du mois</div>
          <div class="kpi-value" id="kpi-inc">—</div>
        </div>
        <div class="kpi">
          <div class="kpi-label">Économies (revenus – dépenses)</div>
          <div class="kpi-value" id="kpi-sav">—</div>
        </div>
      </div>
    </section>

    <!-- Transactions (démo)  -->
    <section class="card" style="margin-top:20px">
      <h2 style="margin:0 0 12px 0">Transactions (démo)</h2>

      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <label for="tx-month" class="muted">Mois :</label>
        <input id="tx-month" type="month" />
        <button id="tx-load" class="btn">Charger</button>
      </div>

      <div style="overflow:auto;margin-top:12px">
        <table class="table" id="tx-table" style="min-width:560px">
          <thead>
            <tr>
              <th>Date</th>
              <th>Libellé</th>
              <th>Catégorie</th>
              <th style="text-align:right">Montant (€)</th>
            </tr>
          </thead>
          <tbody id="tx-tbody">
            <!-- rempli par JS -->
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" style="text-align:right">Total</td>
              <td id="tx-total" style="text-align:right">0,00</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>

  </main>

  <footer class="footer">
    <span id="year"></span> © Econya
  </footer>

  <!-- IMPORTANT : env.js AVANT banque.js -->
  <script src="actifs/env.js"></script>
  <script src="actifs/banque.js"></script>
</body>
</html>

