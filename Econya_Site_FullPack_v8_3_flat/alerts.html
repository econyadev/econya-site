<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Alertes prix — Econya</title>
  <link rel="stylesheet" href="assets/style.css"/>
</head>
<body>
<header>
  <a class="brand" href="index.html"><img src="assets/logo.svg" alt="Econya" style="width:34px;height:34px;border-radius:8px"/> <strong>Econya</strong></a>
  <nav class="nav">
    <a href="assistant.html">Assistant IA</a>
    <a href="comparator.html">Comparateur</a>
    <a href="simulators.html">Simulateurs</a>
    <a href="fuel.html">Essence</a>
    <a href="deals.html">Bon plans</a>
    <a href="alerts.html"><strong>Alertes</strong></a>
    <a href="dashboard.html">Dashboard</a>
  </nav>
</header>
<div class="wrap">
  <h1>Alertes prix</h1>
  <div class="card">
    <div style="display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px">
      <label>BTC ≤ <input id="a-btc" type="number" value="55000"></label>
      <label>Or (oz) ≤ <input id="a-gold" type="number" value="2200"></label>
      <label>SP95 (€/L) ≤ <input id="a-sp95" type="number" step="0.01" value="1.70"></label>
    </div>
    <div style="margin-top:8px">
      <button class="btn" id="save">Enregistrer</button>
    </div>
    <div id="status" class="small" style="margin-top:6px"></div>
  </div>
  <div class="card small">Les alertes sont stockées localement. Si un backend est configuré, elles seront également envoyées (e-mail à venir).</div>
</div>
<footer><div>© 2025 Econya</div></footer>
<script>
function read(){{ try{{ return JSON.parse(localStorage.getItem('econya_alerts')||'{{}}'); }}catch{{return {{}}}} }
function write(v){{ localStorage.setItem('econya_alerts', JSON.stringify(v)); }}
document.getElementById('save').onclick = async ()=>{{
  const cfg = {{ btc: parseFloat(document.getElementById('a-btc').value||'0')||0,
                gold: parseFloat(document.getElementById('a-gold').value||'0')||0,
                sp95: parseFloat(document.getElementById('a-sp95').value||'0')||0 }};
  write(cfg);
  document.getElementById('status').textContent = 'Sauvegardé localement.';
  const api = (localStorage.getItem('econya_verify_api')||'').replace(/\/$/,'');
  if(api){{
    try{{ await fetch(api+'/alerts', {{method:'PUT', headers:{{'Content-Type':'application/json'}}, body: JSON.stringify(cfg)}});
      document.getElementById('status').textContent += ' Envoyé au serveur.';
    }}catch{{}}
  }}
}};
window.addEventListener('DOMContentLoaded', ()=>{{
  const c = read(); if(c.btc) document.getElementById('a-btc').value=c.btc;
  if(c.gold) document.getElementById('a-gold').value=c.gold;
  if(c.sp95) document.getElementById('a-sp95').value=c.sp95;
}});
</script>
<script src="assets/partners-router.js"></script>
<script src="assets/push-subscribe.js"></script>
</body>
</html>
