<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Comparateur – Econya</title>
  <meta name="description" content="Comparez les offres selon vos priorités (prix, satisfaction, empreinte carbone) et voyez l’économie estimée." />
  <link rel="icon" type="image/svg+xml" href="assets/logo.svg" />
  <link rel="stylesheet" href="style.css" />
  <style>
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:16px}
    .card{background:#0f3c2a66;border:1px solid #ffffff12;border-radius:16px;padding:16px}
    .kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-top:12px}
    .kpi{background:#0f3c2a88;border:1px solid #ffffff12;border-radius:12px;padding:12px;text-align:center}
    .score{font-weight:900;font-size:1.4rem;color:#9EF01A}
    .results .item{padding:10px 0;border-bottom:1px dashed #ffffff22}
    .results .item:last-child{border-bottom:none}
    label{display:block;margin:.35rem 0}
  </style>
</head>
<body>
<header class="topbar">
  <a class="brand" href="/">
    <img src="assets/logo.svg" alt="Econya" height="28" />
    <span>Econya</span>
  </a>
  <nav class="nav">
    <a href="comparateur.html" class="active">Comparateur</a>
    <a href="coach-eco.html">Coach Éco</a>
    <a href="deals.html">Bons plans</a>
    <a href="gamification.html">Gamification</a>
    <a href="profil-eco.html">Profil éco</a>
    <a href="banque.html">Banque</a>
    <a href="tarifs.html" class="badge">Tarifs</a>
  </nav>
</header>

<main class="hero">
  <h1>Comparateur</h1>
  <p class="muted">Ajustez les pondérations pour obtenir un score global aligné avec vos priorités.</p>
</main>

<section class="container grid">
  <article class="card">
    <h2>Critères & pondérations</h2>
    <label>Prix <input type="range" min="0" max="100" value="50" id="w-price"></label>
    <label>Satisfaction <input type="range" min="0" max="100" value="30" id="w-rating"></label>
    <label>Empreinte carbone <input type="range" min="0" max="100" value="20" id="w-eco"></label>
    <div class="cta" style="margin-top:10px"><button class="btn" id="btn-compare">Comparer maintenant</button></div>
  </article>

  <article class="card results">
    <h2>Résultats</h2>
    <div id="compare-results"></div>
  </article>
</section>

<section class="container">
  <div class="kpis">
    <div class="kpi"><div id="kpi-save" class="score">0 €</div><small>Économie estimée / an</small></div>
    <div class="kpi"><div id="kpi-co2" class="score">0 kg</div><small>CO₂ évité / an</small></div>
    <div class="kpi"><div id="kpi-time" class="score">0 h</div><small>Temps gagné / an</small></div>
  </div>
</section>

<footer class="footer">
  <span id="year"></span> © Econya
</footer>

<script>
  document.getElementById("year").textContent = new Date().getFullYear();
  const $ = s=>document.querySelector(s);
  const euro = n => (n||0).toLocaleString('fr-FR',{style:'currency',currency:'EUR'});

  const DEMO_OFFERS = [
    { id:'a', name:'Offre A', price:19.99, rating:4.3, eco:0.7 },
    { id:'b', name:'Offre B', price:14.50, rating:4.0, eco:0.5 },
    { id:'c', name:'Offre C', price:24.90, rating:4.8, eco:0.9 },
    { id:'d', name:'Offre D', price: 9.99, rating:3.7, eco:0.4 },
  ];

  function computeScores(offers, w){
    const maxPrice = Math.max(...offers.map(o=>o.price));
    return offers.map(o=>{
      const sPrice  = 1 - (o.price / maxPrice);
      const sRating = o.rating / 5;
      const sEco    = o.eco;
      const totalW  = (w.price||0)+(w.rating||0)+(w.eco||0) || 1;
      const score   = (sPrice*w.price + sRating*w.rating + sEco*w.eco)/totalW;
      return {...o, score};
    }).sort((a,b)=>b.score-a.score);
  }

  function renderCompare(){
    const w = { price:+$("#w-price").value, rating:+$("#w-rating").value, eco:+$("#w-eco").value };
    const ranked = computeScores(DEMO_OFFERS, w);
    $("#compare-results").innerHTML = ranked.map(o=>`
      <div class="item">
        <div><strong>${o.name}</strong></div>
        <div>Prix: ${euro(o.price)} • Note: ${o.rating}/5 • CO₂: ${(1-o.eco).toFixed(2)} kg</div>
        <div>Score: <span class="score">${(o.score*100|0)}/100</span></div>
      </div>`).join('');
    // KPIs démo
    $("#kpi-save").textContent = euro(Math.max(0, 120 - ranked[0].price) * 12);
    $("#kpi-co2").textContent  = (ranked[0].eco*120).toFixed(0)+' kg';
    $("#kpi-time").textContent = (ranked[0].rating*3).toFixed(1)+' h';
  }

  document.getElementById("btn-compare").addEventListener("click", renderCompare);
  renderCompare();
</script>
</body>
</html>

